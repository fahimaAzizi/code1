Add an additional condition to your nested if statement to ensure that paths[node] is non-empty before accessing paths[node][-1].
